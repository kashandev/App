<!DOCTYPE html><html><?php echo $header; ?><body class="skin-josh"><?php echo $page_header; ?><div class="wrapper row-offcanvas row-offcanvas-left"><?php echo $column_left; ?><!-- Right side column. Contains the navbar and content of the page --><!--page level css --><link rel="stylesheet" type="text/css" href="./assets/datatables/css/buttons.bootstrap.css" /><link rel="stylesheet" type="text/css" href="./assets/datatables/css/colReorder.bootstrap.css" /><link rel="stylesheet" type="text/css" href="./assets/datatables/css/rowReorder.bootstrap.css"><link rel="stylesheet" type="text/css" href="./assets/datatables/css/buttons.bootstrap.css" /><link rel="stylesheet" type="text/css" href="./assets/datatables/css/scroller.bootstrap.css" /><link href="./assets/jasny-bootstrap.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="./assets/iCheck/css/all.css"><link rel="stylesheet" type="text/css" href="./assets/iCheck/css/line/line.css"><script type="text/javascript" src="./assets/iCheck/js/icheck.js"></script><!--end of page level css--><aside class="right-side"><!-- Content Header (Page header) --><section class="content-header">    <div class="row">        <div class="col-sm-6">            <h1><?php echo $lang['heading_title']; ?></h1>            <ol class="breadcrumb">                <?php foreach($breadcrumbs as $breadcrumb): ?>                <li>                    <a href="<?php echo $breadcrumb['href']; ?>">                        <i class="<?php echo $breadcrumb['class']; ?>"></i>                        <?php echo $breadcrumb['text']; ?>                    </a>                </li>                <?php endforeach; ?>            </ol>        </div>        <div class="col-sm-6">            <div class="action-button">                <?php if(isset($isEdit) && $isEdit==1): ?>                <?php if($is_post == 0): ?>                <a class="btn btn-info" href="<?php echo $action_post; ?>">                    <i class="fa fa-thumbs-up"></i>                    &nbsp;<?php echo $lang['post']; ?>                </a>                <?php endif; ?>                <button type="button" class="btn btn-info" href="javascript:void(0);" onclick="getDocumentLedger();">                    <i class="fa fa fa-balance-scale"></i>                    &nbsp;<?php echo $lang['ledger']; ?>                </button>                <a class="btn btn-info" target="_blank" href="<?php echo $action_print; ?>">                    <i class="fa fa-print"></i>                    &nbsp;<?php echo $lang['print']; ?>                </a>                <a class="btn btn-success" target="_blank" href="<?php echo $action_print_excel; ?>">                    <i class="fa fa-print"></i>                    &nbsp;Excel                </a>                <?php endif; ?>                <a class="btn btn-default" href="<?php echo $action_cancel; ?>">                    <i class="fa fa-undo"></i>                    &nbsp;<?php echo $lang['cancel']; ?>                </a>                <?php if($is_post == 0): ?>                <a class="btn btn-primary" href="javascript:void(0);" onclick="$('#form').submit();">                    <i class="fa fa-floppy-o"></i>                    &nbsp;<?php echo $lang['save']; ?>                </a>                <?php endif; ?>                <?php if($is_post == 1): ?>                <a class="btn btn-info" target="_blank" href="<?php echo $action_print_barcode; ?>">                    <i class="fa fa-print"></i>                    &nbsp;<?php echo $lang['print_barcode']; ?>                </a>                <?php endif; ?>            </div>        </div>    </div></section><?php if ($error_warning) { ?><div class="col-sm-12">    <div class="alert alert-danger alert-dismissable">        <button class="close" aria-hidden="true" data-dismiss="alert" type="button">x</button>        <?php echo $error_warning; ?>    </div></div><?php } ?><?php  if ($success) { ?><div class="col-sm-12">    <div class="alert alert-success alert-dismissable">        <button class="close" aria-hidden="true" data-dismiss="alert" type="button">x</button>        <?php echo $success; ?>    </div></div><?php  } ?><!-- Main content --><!-- Main content --><section class="content"><div class="row padding-left_right_15"><div class="col-xs-12"><input type="hidden" value="<?php echo $document_type_id; ?>" name="document_type_id" id="document_type_id" /><input type="hidden" value="<?php echo $document_id; ?>" name="document_id" id="document_id" /><form  action="<?php echo $action; ?>" method="post" enctype="multipart/form-data" id="form"><div class="row"><div class="col-md-12"><div class="panel panel-primary" id="hidepanel1"><div class="panel-heading" style="background-color: #90a4ae;">    <h3 class="panel-title"><i class="fa fa-credit-card" ></i>&nbsp;&nbsp;<?php echo $breadcrumb['text']; ?></h3></div><div class="panel-body"><fieldset><div class="row">    <div class="col-sm-3">        <div class="form-group">            <label><?php echo $lang['document_no']; ?></label>            <input class="form-control" type="text" name="document_identity" readonly="readonly" value="<?php echo $document_identity; ?>" placeholder="Auto" />        </div>    </div>    <div class="col-sm-3">        <div class="form-group">            <label><span class="required">*</span>&nbsp;<?php echo $lang['document_date']; ?></label>            <input class="form-control dtpDate" type="text" name="document_date" value="<?php echo $document_date; ?>" />        </div>    </div>    <div class="offset-sm-3 col-sm-3">        <?php if( !empty($ref_document_type_id) ): ?>        <div class="form-group">            <label for="invoice_type"><?= $lang['invoice_type'] ?><span class="required">*</span></label>            <div class="d-flex justify-content-start align-items-center mt-2">                <label for="invoice_type_local" class="mr-5">                    <strong class="mr-1">Local</strong>                    <input type="radio" name="invoice_type" id="invoice_type_local" value="Local" <?= ((strtolower($invoice_type)=='local')?'checked="checked"':'') ?> disabled="disabled">                    <?php if(strtolower($invoice_type)=='local'): ?>                    <input type="hidden" name="invoice_type" value="Local">                    <?php endif; ?>                </label>                <label for="invoice_type_import" class="mr-5">                    <strong class="mr-1">Import</strong>                    <input type="radio" name="invoice_type" id="invoice_type_import" value="Import" <?= ((strtolower($invoice_type)=='import')?'checked="checked"':'') ?> disabled="disabled">                    <?php if(strtolower($invoice_type)=='import'): ?>                    <input type="hidden" name="invoice_type" value="Import">                    <?php endif; ?>                </label>            </div>        </div>        <?php else: ?>        <div class="form-group">            <label for="invoice_type"><?= $lang['invoice_type'] ?><span class="required">*</span></label>            <div class="d-flex justify-content-start align-items-center mt-2">                <label for="invoice_type_local" class="mr-5">                    <strong class="mr-1">Local</strong>                    <input type="radio" name="invoice_type" id="invoice_type_local" value="Local" <?= ((strtolower($invoice_type)=='local')?'checked="checked"':'') ?>>                </label>                <label for="invoice_type_import" class="mr-5">                    <strong class="mr-1">Import</strong>                    <input type="radio" name="invoice_type" id="invoice_type_import" value="Import" <?= ((strtolower($invoice_type)=='import')?'checked="checked"':'') ?>>                </label>            </div>        </div>        <?php endif; ?>    </div></div><div class="row">    <div class="col-sm-3 hide">        <div class="form-group">            <label><?php echo $lang['partner_type']; ?></label>            <select class="form-control" id="partner_type_id" name="partner_type_id">                <option value="">&nbsp;</option>                <?php foreach($partner_types as $partner_type): ?>                <option value="<?php echo $partner_type['partner_type_id']; ?>" <?php echo ($partner_type_id == $partner_type['partner_type_id']?'selected="true"':''); ?>><?php echo $partner_type['name']; ?></option>                <?php endforeach; ?>            </select>        </div>    </div>    <div class="col-sm-3">        <div class="form-group">            <label><?php echo $lang['partner_name']; ?></label>            <select class="form-control" id="partner_id" name="partner_id">                <option value="">&nbsp;</option>            </select>            <label for="partner_id" class="error" style="display: none;"></label>        </div>    </div>    <div class="col-sm-3">        <div class="form-group">            <label><?php echo $lang['ref_document_type']; ?></label>            <select class="form-control" name="ref_document_type_id" id="ref_document_type_id">                <option value="">&nbsp;</option>                <option value="4" <?php echo ($ref_document_type_id == 4 ? 'selected="selected"' :''); ?>><?php echo $lang['purchase_order']; ?></option>                <option value="17" <?php echo ($ref_document_type_id == 17 ? 'selected="selected"' :''); ?>><?php echo $lang['goods_received']; ?></option>            </select>        </div>    </div>    <div class="col-sm-3">        <div class="form-group">            <label id="lbl_ref_document_identity"><?php echo $lang['ref_document_no']; ?></label>            <div class="input-group">                <select class="form-control" id="ref_document_identity" name="ref_document_identity">                    <option value="">&nbsp;</option>                </select>                                        <span class="input-group-btn">                                            <button id="addRefDocument" type="button" class="btn btn-info btn-flat"><i class="fa fa-plus"></i></button>                                        </span>            </div>        </div>    </div></div><div class="row">    <div class="col-sm-3 hide">        <div class="form-group">            <label><?php echo $lang['warehouse'] ?></label>            <select class="form-control select2-default" id="warehouse_id" name="warehouse_id" >                <option value="">&nbsp;</option>                <?php foreach($warehouses as $warehouse): ?>                <option value="<?php echo $warehouse['warehouse_id']; ?>" <?php echo ($warehouse_id == $warehouse['warehouse_id']?'selected="true"':''); ?>><?php echo $warehouse['name']; ?></option>                <?php endforeach; ?>            </select>        </div>    </div>    <div class="col-sm-3">        <div class="form-group">            <label><?php echo $lang['base_currency']; ?></label>            <input type="hidden" id="base_currency_id" name="base_currency_id"  value="<?php echo $base_currency_id; ?>" />            <input type="text" class="form-control" id="base_currency" name="base_currency" readonly="true" value="<?php echo $base_currency; ?>" />        </div>    </div>    <div class="col-sm-3">        <div class="form-group">            <label><?php echo $lang['document_currency']; ?></label>            <input class="form-control" type="hidden" id="document_currency_id" name="document_currency_id"  value="<?php echo $document_currency_id; ?>" />            <input class="form-control" type="text" id="document_currency_name" name="document_currency_name"  value="<?php echo $document_currency_name; ?>" readonly="readonly"/>        </div>    </div>    <div class="col-sm-3">        <div class="form-group">            <label><?php echo $lang['conversion_rate']; ?></label>            <input class="form-control fDecimal" id="conversion_rate" type="text" name="conversion_rate" value="<?php echo round_decimal($conversion_rate,4); ?>" />        </div>    </div></div><div class="row">    <div class="col-sm-6">        <div class="form-group">            <label><?php echo $lang['remarks']; ?></label>            <input class="form-control" type="text" name="remarks" id="remarks" value="<?php echo $remarks; ?>" />        </div>    </div></div><br><br><div class="row"><div class="col-sm-12"><div class="table-responsive form-group"><table id="tblPurchaseInvoice" class="table table-striped table-bordered" style="width: 4000px !important;"><thead><tr align="center" data-row_id="H">    <td style="width: 7px; !important;">        <a title="Add" class="btn btn-xs btn-primary btnAddGrid" href="javascript:void(0);"><i class="fa fa-plus"></i></a>    </td>    <td style="width: 150px"><?php echo $lang['document']; ?></td>    <!--<td style="width: 350px"><?php echo $lang['project']; ?></td>-->    <td style="width: 350px"><?php echo $lang['product_name']; ?></td>    <td style="width: 300px"><?php echo $lang['description']; ?></td>    <td style="width: 300px"><?php echo $lang['batch_no']; ?></td>    <td style="width: 300px"><?php echo $lang['serial_no']; ?></td>    <td style="width: 300px"><?php echo $lang['stock_unit']; ?></td>    <td style="width: 300px"><?php echo $lang['warehouse']; ?></td>    <td style="width: 150px"><?php echo $lang['quantity']; ?></td>    <td style="width: 150px"><?php echo $lang['unit_price']; ?></td>    <td style="width: 150px;"><?php echo $lang['total_price']; ?></td>    <td style="width: 150px;"><?php echo $lang['total_price_pkr']; ?></td>    <td style="width: 150px;"><?php echo $lang['unit_price_pkr']; ?></td>    <!--<td style="width: 150px;"><?php echo $lang['freight']; ?></td>-->    <td style="width: 150px;"><?php echo $lang['custom_duty']; ?></td>    <td style="width: 150px;"><?php echo $lang['additional_custom_duty']; ?></td>    <td style="width: 150px;"><?php echo $lang['regulatory_duty']; ?></td>    <!--<td style="width: 150px;"><?php echo $lang['sales_tax_percent']; ?></td>-->    <td style="width: 150px;"><?php echo $lang['sales_tax']; ?></td>    <td style="width: 150px;"><?php echo $lang['additional_sales_tax']; ?></td>    <td style="width: 150px;"><?php echo $lang['income_tax']; ?></td>    <td style="width: 150px;"><?php echo $lang['total_duties']; ?></td>    <td style="width: 150px;"><?php echo $lang['other_duties_and_charges']; ?></td>    <td style="width: 150px;"><?php echo $lang['total_duties_and_charges']; ?></td>    <td style="width: 150px;"><?php echo $lang['total_landed_cost']; ?></td>    <td style="width: 150px;"><?php echo $lang['net_unit_cost']; ?></td>    <td style="width: 150px;"><?php echo $lang['additional_unit_cost']; ?></td>    <td style="width: 7px; !important;">        <a title="Add" class="btn btn-xs btn-primary btnAddGrid" href="javascript:void(0);"><i class="fa fa-plus"></i></a>    </td></tr></thead><tbody ><?php foreach($purchase_invoice_details as $grid_row => $detail): ?><tr id="grid_row_<?php echo $grid_row; ?>" data-row_id="<?php echo $grid_row; ?>">    <td>        <a onclick="removeRow(this);" title="Remove" class="btn btn-xs btn-danger" href="javascript:void(0);"><i class="fa fa-times"></i></a>        <a title="Add" class="btn btn-xs btn-primary btnAddGrid" href="javascript:void(0);"><i class="fa fa-plus"></i></a>    </td>    <td>        <input type="hidden" name="purchase_invoice_details[<?php echo $grid_row; ?>][purchase_order_detail_id]" id="purchase_invoice_detail_purchase_order_detail_id_<?php echo $grid_row; ?>" value="<?php echo $detail['purchase_order_detail_id']; ?>" />        <input type="hidden" name="purchase_invoice_details[<?php echo $grid_row; ?>][goods_received_detail_id]" id="purchase_invoice_detail_goods_received_detail_id_<?php echo $grid_row; ?>" value="<?php echo $detail['goods_received_detail_id']; ?>" />        <input type="hidden" name="purchase_invoice_details[<?php echo $grid_row; ?>][ref_document_type_id]" id="purchase_invoice_detail_ref_document_type_id_<?php echo $grid_row; ?>" value="<?php echo $detail['ref_document_type_id']; ?>" />        <input type="hidden" name="purchase_invoice_details[<?php echo $grid_row; ?>][ref_document_identity]" id="purchase_invoice_detail_ref_document_identity_<?php echo $grid_row; ?>" value="<?php echo $detail['ref_document_identity']; ?>" />        <a target="_blank" href="<?php echo $detail['href']; ?>"><?php echo $detail['ref_document_identity']; ?></a>    </td>    <!--<td style="min-width: 150px;">        <?php if( !empty($detail['ref_document_identity']) ): ?>        <input type="hidden" name="purchase_invoice_details[<?= $grid_row ?>][project_id]" id="purchase_invoice_detail_project_id_<?php echo $grid_row; ?>" value="<?= $detail['project_id'] ?>">        <input type="hidden" name="purchase_invoice_details[<?= $grid_row ?>][sub_project_id]" id="purchase_invoice_detail_sub_project_id_<?php echo $grid_row; ?>" value="<?= $detail['sub_project_id'] ?>">        <input type="text" class="form-control" value="<?= $detail['project'] .' - '. $detail['sub_project'] ?>" readonly>        <?php else: ?>        <input type="hidden" id="purchase_invoice_detail_project_id_<?= $grid_row ?>" name="purchase_invoice_details[<?= $grid_row ?>][project_id]" value="<?= $detail['project_id'] ?>" />        <select class="form-control Select2SubProject " id="purchase_invoice_detail_sub_project_id_<?= $grid_row ?>" name="purchase_invoice_details[<?= $grid_row ?>][sub_project_id]"  style="width: 350px">            <option value="<?= $detail[sub_project_id] ?>"><?= $detail['project'].' - '.$detail['sub_project'] ?></option>        </select>        <?php endif; ?>        <label for="purchase_invoice_detail_sub_project_id_<?= $grid_row ?>" class="error" style="display: none"></label>    </td>-->    <td style="min-width: 250px;">        <input type="hidden" id="purchase_invoice_detail_type_of_material_<?php echo $grid_row; ?>" value="<?php echo $detail['type_of_material']; ?>" />        <?php if( !empty($detail['ref_document_identity']) ): ?>        <input type="hidden" name="purchase_invoice_details[<?php echo $grid_row; ?>][product_code]" id="purchase_invoice_detail_product_code_<?php echo $grid_row; ?>" value="<?php echo $detail['product_code']; ?>" />        <input type="hidden" id="purchase_invoice_detail_product_id_<?php echo $grid_row; ?>" name="purchase_invoice_details[<?php echo $grid_row; ?>][product_id]" value="<?= $detail['product_id'] ?>">        <input type="text" class="form-control" value="<?= implode(' - ', array(                    $detail['product_code'],                    $detail['brand'],                    $detail['model'],                    $detail['product_name'],                )) ?>" readonly>        <?php else: ?>        <input type="hidden" class="form-control" name="purchase_invoice_details[<?= $grid_row ?>][product_code]" id="purchase_invoice_detail_product_code_<?= $grid_row ?>" value="<?= $detail['product_code'] ?>" />        <select class="required form-control Select2Product required" id="purchase_invoice_detail_product_id_<?= $grid_row ?>" name="purchase_invoice_details[<?= $grid_row ?>][product_id]" required>            <option value="<?= $detail['product_id'] ?>"><?= implode(' - ', array(                    $detail['product_code'],                    $detail['brand'],                    $detail['model'],                    $detail['product_name'],                )) ?></option>        </select>        <?php endif; ?>        <label for="purchase_invoice_detail_product_id_<?= $grid_row ?>" class="error" style="display: none"></label>    </td>    <td>        <textarea  type="text" style="width: 300px" rows="2" class="form-control" name="purchase_invoice_details[<?php echo $grid_row; ?>][description]" id="purchase_invoice_detail_description_<?php echo $grid_row; ?>"><?php echo $detail['description']; ?></textarea>    </td>    <td>        <input type="text" class="form-control" name="purchase_invoice_details[<?php echo $grid_row; ?>][batch_no]" id="purchase_invoice_detail_batch_no_<?php echo $grid_row; ?>" value="<?php echo $detail['batch_no']; ?>" />    </td>    <td>        <input type="text" class="form-control" name="purchase_invoice_details[<?php echo $grid_row; ?>][serial_no]" id="purchase_invoice_detail_serial_no_<?php echo $grid_row; ?>" value="<?php echo $detail['serial_no']; ?>" />    </td>    <td>        <input type="hidden" name="purchase_invoice_details[<?php echo $grid_row; ?>][unit_id]" id="purchase_invoice_detail_unit_id_<?php echo $grid_row; ?>" value="<?php echo $detail['unit_id']; ?>" />        <input type="text" class="form-control" name="purchase_invoice_details[<?php echo $grid_row; ?>][unit]" id="purchase_invoice_detail_unit_<?php echo $grid_row; ?>" value="<?php echo $detail['unit']; ?>" readonly="readonly" />    </td>    <td>        <select required name="purchase_invoice_details[<?php echo $grid_row; ?>][warehouse_id]" id="purchase_invoice_detail_charge_warehouse_id_<?php echo $grid_row; ?>" class="form-control select2 required">            <option value="">&nbsp;</option>            <?php foreach($warehouses as $warehouse): ?>            <option value="<?php echo $warehouse['warehouse_id']; ?>" <?php echo ($detail['warehouse_id'] == $warehouse['warehouse_id']?'selected="true"':''); ?>><?php echo $warehouse['name']; ?></option>            <?php endforeach; ?>        </select>        <label for="purchase_invoice_detail_warehouse_id_<?php echo $grid_row; ?>" class="error" style="display: none"></label>    </td>    <td>        <input onchange="calculateCalcWeight(this);" style="min-width: 100px; text-align: right" type="text" class="form-control fPDecimal" name="purchase_invoice_details[<?= $grid_row ?>][qty]" id="purchase_invoice_detail_qty_<?= $grid_row ?>" value="<?= round_decimal($detail['qty'],4) ?>" />    </td>    <td>        <input type="text" onchange="calculateTotalRow(this);" style="min-width: 100px; text-align: right" class="form-control fPDecimal" name="purchase_invoice_details[<?= $grid_row ?>][unit_price]" id="purchase_invoice_detail_unit_price_<?= $grid_row ?>" value="<?= $detail['unit_price'] ?>" readonly/>    </td>    <td>        <input type="text" onchange="calculateTotalRow(this);" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_total_price_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][total_price]" value="<?= $detail['total_price'] ?>" readonly />    </td>    <td>        <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_total_price_pkr_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][total_price_pkr]" value="<?= $detail['total_price_pkr'] ?>" readonly />    </td>    <td>        <input type="text" style="min-width: 100px ; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_unit_price_pkr_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][unit_price_pkr]" value="<?= $detail['unit_price_pkr'] ?>" readonly/>    </td>    <td class="hide">    <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_freight_charges_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][freight_charges]" value="<?= $detail['freight_charges'] ?>" readonly/>    </td>    <td>        <input type="text" onchange="calculateTotalRow(this)" style="min-width: 100px; text-align: right" class="form-control fPInteger" id="purchase_invoice_detail_custom_duty_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][custom_duty]" value="<?= round_decimal($detail['custom_duty'],0) ?>" />    </td>    <td>        <input type="text" onchange="calculateTotalRow(this)" style="min-width: 100px; text-align: right" class="form-control fPInteger" id="purchase_invoice_detail_additional_custom_duty_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][additional_custom_duty]" value="<?= round_decimal($detail['additional_custom_duty'],0) ?>" />    </td>    <td>        <input type="text" onchange="calculateTotalRow(this)" style="min-width: 100px; text-align: right" class="form-control fPInteger" id="purchase_invoice_detail_regulatory_duty_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][regulatory_duty]" value="<?= round_decimal($detail['regulatory_duty'],0) ?>" />    </td>    <td hidden="hidden">        <input onchange="calculateSalesTaxAmount(this)" type="text" style="min-width: 100px;" class="form-control fPDecimal" name="purchase_invoice_details[<?= $grid_row ?>][sales_tax_percent]" id="purchase_invoice_detail_sales_tax_percent_<?= $grid_row ?>" value="<?= round_decimal($detail['sales_tax_percent'],0) ?>" />    </td>    <td>        <input type="text" onchange="calculateSalesTaxPercent(this)" style="min-width: 100px; text-align: right" class="form-control fPInteger" id="purchase_invoice_detail_sales_tax_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][sales_tax]" value="<?= round_decimal($detail['sales_tax'],0) ?>" />    </td>    <td>        <input type="text" onchange="calculateTotalRow(this)" style="min-width: 100px; text-align: right" class="form-control fPInteger" id="purchase_invoice_detail_additional_sales_tax_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][additional_sales_tax]" value="<?= round_decimal($detail['additional_sales_tax'],0) ?>" />    </td>    <td>        <input type="text" onchange="calculateTotalRow(this)" style="min-width: 100px; text-align: right" class="form-control fPInteger" id="purchase_invoice_detail_income_tax_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][income_tax]" value="<?= round_decimal($detail['income_tax'],0) ?>" />    </td>    <td>        <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_total_duties_and_charges_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][total_duties_and_charges]" value="<?= round_decimal($detail['total_duties_and_charges'],0) ?>" readonly/>    </td>    <td>        <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_other_expense_and_charges_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][other_expense_and_charges]" value="<?= $detail['other_expense_and_charges'] ?>" readonly/>    </td>    <td>        <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_total_other_duties_and_charges_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][total_other_duties_and_charges]" value="<?= $detail['total_other_duties_and_charges'] ?>" readonly/>    </td>    <td>        <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_total_landed_cost_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][total_landed_cost]" value="<?= $detail['total_landed_cost'] ?>" readonly/>    </td>    <td>        <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_net_unit_cost_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][net_unit_cost]" value="<?= $detail['net_unit_cost'] ?>" readonly/>    </td>    <td>        <input type="text" style="min-width: 100px; text-align: right" class="form-control fPDecimal" id="purchase_invoice_detail_additional_unit_cost_<?= $grid_row ?>"  name="purchase_invoice_details[<?= $grid_row ?>][additional_unit_cost]" value="<?= $detail['additional_unit_cost'] ?>" readonly/>    </td>    <td>        <a onclick="removeRow(this);" title="Remove" class="btn btn-xs btn-danger" href="javascript:void(0);"><i class="fa fa-times"></i></a>        &nbsp;        <a title="Add" class="btn btn-xs btn-primary btnAddGrid" href="javascript:void(0);"><i class="fa fa-plus"></i></a>    </td></tr><?php endforeach; ?><?php $grid_row = count($purchase_invoice_details); ?></tbody><tfoot><tr align="center" data-row_id="H">    <td colspan="8" style="text-align: right"><b>Total</b></td>    <td>        <input class="form-control fDecimal" type="text" id="qty_master" name="qty_master" value="<?php echo round_decimal($qty_master,4); ?>" readonly="readonly" />    </td>    <td></td>    <td>        <input class="form-control fDecimal" type="text" id="total_price_master" name="total_price_master" value="<?php echo round_decimal($total_price_master,2); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fDecimal" type="text" id="total_price_pkr_master" name="total_price_pkr_master" value="<?php echo round_decimal($total_price_pkr_master,2); ?>" readonly="readonly" />    </td>    <td></td>    <td class="hide">        <input onchange="calculateTotalFreight()" class="form-control fDecimal" type="text" id="freight_master" name="freight_master" value="<?php echo round_decimal($freight_master,2); ?>" />    </td>    <td>        <input class="form-control fPInteger" type="text" id="custom_duty_master" name="custom_duty_master" value="<?php echo round_decimal($custom_duty_master); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fPInteger" type="text" id="additional_custom_duty_master" name="additional_custom_duty_master" value="<?php echo round_decimal($additional_custom_duty_master,0); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fPInteger" type="text" id="regulatory_duty_master" name="regulatory_duty_master" value="<?php echo round_decimal($regulatory_duty_master,0); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fPInteger" type="text" id="sales_tax_master" name="sales_tax_master" value="<?php echo round_decimal($sales_tax_master); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fPInteger" type="text" id="additional_sales_tax_master" name="additional_sales_tax_master" value="<?php echo round_decimal($additional_sales_tax_master); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fPInteger" type="text" id="income_tax_master" name="income_tax_master" value="<?php echo round_decimal($income_tax_master); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fPInteger" type="text" id="total_duties_master" name="total_duties_master" value="<?php echo round_decimal($total_duties_master); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fDecimal" type="text" id="total_other_expense_master" name="total_other_expense_master" value="<?php echo round_decimal($total_other_expense_master,2); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fDecimal" type="text" id="total_other_duties_master" name="total_other_duties_master" value="<?php echo round_decimal($total_other_duties_master,2); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fDecimal" type="text" id="total_landed_cost_master" name="total_landed_cost_master" value="<?php echo round_decimal($total_landed_cost_master,2); ?>" readonly="readonly" />    </td>    <td>        <input class="form-control fDecimal" type="hidden" id="net_unit_cost_master" name="net_unit_cost_master" value="<?php echo round_decimal($net_unit_cost_master,2); ?>" readonly="readonly" />    </td>    <td></td>    <td style="width: 1%; !important;"></td></tr></tfoot></table></div></div></div><br><br><div class="row">    <div class="col-sm-8">        <div class="QA_table table-responsive">            <table id="tblExpense" class="table table-bordered" style="width:100%">                <thead>                <tr>                    <th style="min-width: 3px !important;">                        <a class="btnAddExpense btn btn-xs btn-primary" title="Add" href="javascript:void(0);"><i class="fa fa-plus"></i></a>                    </th>                    <th class="text-center" style="width: 65%"><?php echo $lang['other_shipment_expenses']; ?></th>                    <th class="text-center"><?php echo $lang['amount']; ?></th>                </tr>                </thead>                <tbody>                <?php $expense_row=0; ?>                <?php foreach($purchase_invoice_expenses as $expense): ?>                <tr id="expense_row_<?php echo $expense_row; ?>" data-expense_row="<?php echo $expense_row; ?>">                    <td>                        <a onclick="removeExpense(this);" title="Remove" class="btn btn-xs btn-danger" href="javascript:void(0);"><i class="fa fa-times"></i></a>                    </td>                    <td>                        <!--<select class="form-control select2" id="purchase_invoice_expense_<?php echo $expense_row; ?>_coa_id" name="purchase_invoice_expenses[<?php echo $expense_row; ?>][coa_id]">                            <option value="">&nbsp;</option>                            <?php foreach($coas as $coa): ?>                            <option value="<?php echo $coa['coa_level3_id']; ?>" <?php echo ($coa['coa_level3_id']==$expense['coa_id']?'selected':'');?>><?php echo $coa['level3_display_name']; ?></option>                            <?php endforeach; ?>                        </select>-->                        <input type="text" class="form-control" id="purchase_invoice_expense_<?php echo $expense_row; ?>_description" name="purchase_invoice_expenses[<?php echo $expense_row; ?>][description]" value="<?php echo $expense['description']; ?>" />                    </td>                    <td>                        <input onchange="calculateExpense(this);" type="text" class="form-control fPDecimal text-right" id="purchase_invoice_expense_<?php echo $expense_row; ?>_expense_amount" name="purchase_invoice_expenses[<?php echo $expense_row; ?>][expense_amount]" value="<?php echo $expense['expense_amount']; ?>" />                    </td>                </tr>                <?php $expense_row++; ?>                <?php endforeach; ?>                </tbody>                <tfoot>                <tr>                    <td></td>                    <td style="text-align: right"><b>Total</b></td>                    <td>                        <input style="text-align: right;" class="form-control" type="text" onchange="calculateExpense(this)" id="expense_total" name="expense_total" value="<?php echo round_decimal($expense_total,2) ?>" readonly="readonly">                    </td>                </tr>                </tfoot>            </table>        </div>    </div></div><br><br><div class="row">    <div class="col-sm-8">        <div class="QA_table table-responsive">            <table id="tblSalesTax" class="table table-bordered" style="width:100%">                <thead>                <tr>                    <th style="min-width: 3px !important;">                        <a class="btnAddSalesTax btn btn-xs btn-primary" title="Add" href="javascript:void(0);"><i class="fa fa-plus"></i></a>                    </th>                    <th class="text-center" style="width: 65%"><?php echo $lang['refunds_working']; ?></th>                    <th class="text-center"><?php echo $lang['amount']; ?></th>                </tr>                </thead>                <tbody>                <?php $sales_tax_row=0; ?>                <?php foreach($purchase_invoice_sales_taxs as $sale_tax): ?>                <tr id="sales_tax_row_<?php echo $sales_tax_row; ?>" data-sales_tax_row="<?php echo $sales_tax_row; ?>">                    <td>                        <a onclick="removeSalesTax(this);" title="Remove" class="btn btn-xs btn-danger" href="javascript:void(0);"><i class="fa fa-times"></i></a>                    </td>                    <td>                        <select class="form-control" id="purchase_invoice_sales_tax_<?php echo $sales_tax_row; ?>_coa_id" name="purchase_invoice_sales_tax[<?php echo $sales_tax_row; ?>][coa_id]">                            <option value="">&nbsp;</option>                            <?php foreach($coas as $coa): ?>                            <option value="<?php echo $coa['coa_level3_id']; ?>" <?php echo ($coa['coa_level3_id']==$sale_tax['coa_id']?'selected':'');?>><?php echo $coa['level3_display_name']; ?></option>                            <?php endforeach; ?>                        </select>                    </td>                    <td>                        <input onchange="calculateSalesTax(this);" type="text" class="form-control fPDecimal text-right" id="purchase_invoice_sales_tax_<?php echo $sales_tax_row; ?>_sales_tax_amount" name="purchase_invoice_sales_tax[<?php echo $sales_tax_row; ?>][sales_tax_amount]" value="<?php echo $sale_tax['sales_tax_amount']; ?>" />                    </td>                </tr>                <?php $sales_tax_row++; ?>                <?php endforeach; ?>                </tbody>                <tfoot>                <tr>                    <td></td>                    <td style="text-align: right"><b>Total</b></td>                    <td>                        <input style="text-align: right;" class="form-control" type="text" onchange="calculateSalesTax(this)" id="sales_tax_total" name="sales_tax_total" value="<?php echo round_decimal($sales_tax_total,2) ?>" readonly="readonly">                    </td>                </tr>                </tfoot>            </table>        </div>    </div></div></div></fieldset></div></div></div></div></form></div><!-- /.col --></div><!-- /.row --></section><!-- /.content --></aside><!-- right-side --></div><a id="back-to-top" href="#" class="btn btn-primary btn-lg back-to-top" role="button" title="Return to top" data-toggle="tooltip" data-placement="left">    <i class="livicon" data-name="plane-up" data-size="18" data-loop="true" data-c="#fff" data-hc="white"></i></a><?php echo $page_footer; ?><?php echo $footer; ?><link rel="stylesheet" href="./assets/plugins/dataTables/dataTables.bootstrap.css"><script src="./assets/plugins/dataTables/jquery.dataTables.js"></script><script src="./assets/plugins/dataTables/dataTables.bootstrap.js"></script><script type="text/javascript" src="./admin/view/js/inventory/purchase_invoice.js"></script><script type="text/javascript" src="./assets/validate/jquery.validate.min.js"></script><script src="./assets/jasny-bootstrap.js" type="text/javascript"></script><script>    jQuery('#form').validate(<?php echo $strValidation; ?>);    var $lang = <?php echo json_encode($lang) ?>;    var $partner_id = '<?php echo $partner_id; ?>';    var $grid_row = '<?php echo $grid_row; ?>';    var $expense_row = '<?php echo $expense_row; ?>';    var $sales_tax_row = '<?php echo $sales_tax_row; ?>';    var $UrlGetRefDocumentNo = '<?php echo $href_get_ref_document_no; ?>';    var $UrlGetPuchaseOrder = '<?php echo $href_get_purchase_order; ?>';    var $UrlGetGoodsReceived = '<?php echo $href_get_goods_received; ?>';    var $UrlGetRefDocument = '<?php echo $href_get_ref_document; ?>';    var $UrlGetProductJSON = '<?php echo $href_get_product_json; ?>';    var $warehouses = <?php echo json_encode($warehouses) ?>;    var $coas = <?php echo json_encode($coas) ?>;    var $sales_tax_account = <?php echo json_encode($sales_tax_account) ?>;    var $sales_tax_adjustable_account = <?php echo json_encode($sales_tax_adjustable_account) ?>;    var $file_nos = <?php echo json_encode($file_nos) ?>;    $(function(){        $('#partner_type_id').trigger('change');    })    function formatRepo (repo) {        if (repo.loading) return repo.text;        var markup = "<div class='select2-result-repository clearfix'>";//        if(repo.image_url) {//            markup +="<div class='select2-result-repository__avatar'><img src='" + repo.image_url + "' /></div>";//        }        markup +="<div class='select2-result-repository__meta'>";        markup +="  <div class='select2-result-repository__title'>" + repo.name + "</div>";//        if (repo.description) {//            markup += "<div class='select2-result-repository__description'>" + repo.description + "</div>";//        }//        markup += "<div class='select2-result-repository__statistics'>" +//                "   <div class='help-block'>" + repo.length + " X " + repo.width + " X " + repo.thickness + "</div>" +        "</div>" +        "</div></div>";        return markup;    }    function formatRepoSelection (repo) {        return repo.name || repo.text;    }    function Select2ProductPurchaseInvoice(obj) {        var $Url = '<?php echo $href_get_json_products_for_purchase_invoice; ?>';        select2OptionList(obj,$Url);    }    <?php if($this->request->get['purchase_invoice_id']): ?>    $(document).ready(function() {        $('.Select2SubProject').each(function(index, element){            var $ele = $(element);            var $row_id = $ele.parent().parent().data('row_id');            Select2SubProject('#purchase_invoice_detail_sub_project_id_'+$row_id);            $('#purchase_invoice_detail_sub_project_id_'+$row_id).on('select2:select', function (e) {                var $row_id = $(this).parent().parent().data('row_id');                var $data = e.params.data;                $('#purchase_invoice_detail_project_id_'+$row_id).val($data['project_id']);            });        })        $('.Select2Product').each(function(index, element){            var $ele = $(element);            var $row_id = $ele.parent().parent().data('row_id');            Select2ProductPurchaseInvoice('#purchase_invoice_detail_product_id_'+$row_id);            $('#purchase_invoice_detail_product_id_'+$row_id).on('select2:select', function (e) {                var $row_id = $(this).parent().parent().data('row_id');                var $data = e.params.data;                $('#purchase_invoice_detail_product_code_'+$row_id).val($data['product_code']);                $('#purchase_invoice_detail_base_calc_weight_'+$row_id).val($data['calc_weight']);            });        });        // calculateTotal();    });    <?php endif; ?>    $('#form').on('submit', function(){        console.log( $(this).valid() )    })</script></body></html>